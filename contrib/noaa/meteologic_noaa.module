<?php
/**
 * @file
 * Meteologic NOAA module.
 */

/**
 * Implements hook_meteologic_provider_info();
 */
function meteologic_noaa_meteologic_provider_info() {
  return array(
    'noaa' => array(
      'name' => t('NOAA'),
      'settings' => 'meteologic_noaa_settings_form',
      'feeds' => array(
        'current' => array(
          'path' => 'http://w1.weather.gov/xml/current_obs/@station.xml',
          'theme' => array(
            'block' => 'meteologic_noaa_current',
            'page' => 'meteologic_noaa_current',
          ),
        ),
      ),
      'stations' => array(
        'weather' => 'meteologic_noaa_stations_weather',
        'radar' => 'meteologic_noaa_stations_radar',
      ),
    ),
  );
}

/**
 * Form callback.
 * Display settings form for Meteologic Mesowest.
 */
function meteologic_noaa_settings_form() {
  $form = array();

  // @TODO insert options here.

  return system_settings_form($form);
}

/**
 * Returns a list of weather stations for the NOAA provider.
 * This is a wrapper around _meteologic_noaa_stations_weather(), which allows
 * us to lazy-load the extra big file.
 */
function meteologic_noaa_stations_weather() {
  module_load_include('inc', 'meteologic_noaa', 'meteologic_noaa_stations');
  return _meteologic_noaa_stations_weather();
}

/**
 * Returns a list of radar stations for the NOAA provider.
 * This is a wrapper around _meteologic_noaa_stations_radar(), which allows
 * us to lazy-load the extra big file.
 */
function meteologic_noaa_stations_radar() {
  module_load_include('inc', 'meteologic_noaa', 'meteologic_noaa_stations');
  return _meteologic_noaa_stations_radar();
}

/**
 * Implements hook_theme().
 *
 * @TODO move this to main module?
 */
function meteologic_noaa_theme($existing, $type, $theme, $path) {
  return array(
    'meteologic_noaa_current' => array(
      'variables' => array('data' => array()),
      'file' => 'meteologic_noaa.theme.inc',
    ),
  );
}